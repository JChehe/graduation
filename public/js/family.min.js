var addUserDialog=$("#add-user"),addUserForm=addUserDialog.find("form"),userTable=$("table");addUserDialog.find(":submit").click(function(e){$.ajax({url:addUserForm.attr("action"),type:addUserForm.attr("method"),data:addUserForm.serialize()}).done(function(e){if(e.status){var t=e.user;$("<tr data-uid="+t.uid+" data-role="+t.role+"><td>"+t.account+"</td><td>"+t.real_name+"</td><td data-sex="+t.sex+">"+("0"==t.sex?"男":"女")+"</td><td>"+(void 0==t.age?"未填写":t.age)+"</td><td>"+t.address+"</td><td>"+t.phone+"</td><td>"+t.tel_phone+"</td></tr>").prependTo(userTable.find("tbody")),addUserDialog.modal("hide"),addUserForm.trigger("reset")}}).fail(function(e,t,d){console.log("textStatus:"+t),console.log("errorThrown:"+d)})});var editUserDialog=$("#edit-user"),curTr=null;userTable.find("tbody").on("click",".edit_btn",function(e){curTr=$(this).closest("tr");var t=curTr.find("td");editUserDialog.find("[name='account']").val(t.eq(0).text()).end().find("[name='real_name']").val(t.eq(1).text()).end().find("[name='sex']").each(function(){return $(this).val()==t.eq(2).data("sex")?($(this).attr("checked",!0),!1):void 0}).end().find("[name='role']").each(function(){return $(this).val()==curTr.data("role")?($(this).attr("checked",!0),!1):void 0}).end().find("[name='id_card']").val(curTr.data("idcard")).end().find("[name='height']").val(curTr.data("height")).end().find("[name='weight']").val(curTr.data("weight")).end().find("[name='medical_case']").val(curTr.data("medicalcase")).end().find("[name='address']").val(t.eq(4).text()).end().find("[name='tel_phone']").val(t.eq(6).text()).end().find("[name='phone']").val(t.eq(5).text()).end().find("[name=edit_user_id]").val(curTr.data("uid")),editUserDialog.modal("show")});var editUserDialog=$("#edit-user"),editUserForm=editUserDialog.find("form");editUserDialog.find(":submit").click(function(e){$.ajax({url:editUserForm.attr("action"),type:editUserForm.attr("method"),data:editUserForm.serialize()}).done(function(e){if(alert(e.info),e.status){var t=e.user;curTr.find("td").eq(1).text(t.real_name).end().eq(2).text(0==t.sex?"男":"女").end().eq(3).text(t.age).end().eq(4).text(t.address).end().eq(5).text(t.phone).end().eq(6).text(t.tel_phone),curTr.data({idcard:t.id_card,height:t.height,weight:t.weight,birthday:t.birthday,medicalcase:t.medical_case}),editUserDialog.modal("hide"),editUserForm.trigger("reset")}}).fail(function(e,t,d){console.log("textStatus:"+t),console.log("errorThrown:"+d)})});
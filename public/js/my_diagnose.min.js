var diagnoseDialog=$("#diagnose_dialog"),diagnosePatient=diagnoseDialog.find(".patient_name"),diagnoseDoctor=diagnoseDialog.find(".diagnose_doctor"),diagnoseContent=diagnoseDialog.find(".diagnose_content");$("#diagnose_table").on("click",".view_diagnose",function(t){var o=$(this).closest("tr"),a=o.data("patient"),e=o.data("doctor"),n=o.data("diagnoseContent");diagnosePatient.text("病人名字："+a),diagnoseDoctor.text("诊断医生："+e),diagnoseContent.text(n)});var searchForm=$("#search-form"),diagnoseList=$("#diagnose_table").find("tbody");searchForm.submit(function(t){t.preventDefault(),$.ajax({url:$(this).attr("action"),type:$(this).attr("method"),data:$(this).serialize()}).done(function(t){console.log(t),diagnoseList.empty();for(var o="",a=0,e=t.diagnoseList.length;e>a;a++){var n=t.diagnoseList[a],i=n.patient.role_prop.real_name,d=0==n.patient.role_prop.sex?"男":"女",s=n.patient.role_prop.age,r=moment(n.update_time||n.update_time).format("YYYY年MM月DD日 HH:MM:SS");o+='<tr data-patient="'+i+'" data-doctor="'+n.doctor_name+'" data-content="'+n.content+'"><td>'+i+"</td><td>"+d+"</td><td>"+s+"</td><td>"+r+"</td><td>"+n.doctor_name+"</td><td>"+n.content+'</td><td><button data-toggle="modal" data-target="#diagnose_dialog" class="btn btn-success btn-sm view_diagnose">查看诊断信息</button></td></tr>'}diagnoseList.html(o)}).fail(function(t,o,a){console.log("textStatus:"+o),console.log("errorThrown:"+a)})});